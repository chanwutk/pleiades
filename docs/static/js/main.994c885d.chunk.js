(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{364:function(e,t,n){e.exports=n(489)},369:function(e,t,n){},489:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(73),i=n.n(c),o=(n(369),n(531)),l=n(49),u=n(539),s=n(35),f=n(180),d=n.n(f),p=n(333),m=n.n(p),v=n(282),h=n.n(v),b=n(223),O=n(540),g=function(e){return{tag:"failure",value:e}},y=n(327),w=n.n(y),j=n(160),E=n.n(j),k=n(329),C=n.n(k),S=n(559),x=n(505),V=n(558),I=n(534),N=n(541),P=n(308);!function e(t){if("object"===typeof t&&null!==t)for(var n in t.description&&(t.markdownDescription=t.description),t)t.hasOwnProperty(n)&&(t[n]=e(t[n]));return t}(P);var D=Object(o.a)(function(e){return{textField:{marginTop:e.spacing(0),marginBottom:e.spacing(4),width:300},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1)},errorMessage:{fontStyle:"italic",color:"red"}}}),R=[{schema:P,uri:"https://vega.github.io/schema/vega-lite/v3.json"}],F=function(e){var t=e.isOpen,n=e.onClose,a=e.value,c=e.onChange,i=e.alias,o=e.setAlias,l=e.errorMsg,u=e.extras,s=D();return r.a.createElement(V.a,{open:t,onClose:n,"aria-labelledby":"form-dialog-title",maxWidth:"lg",fullWidth:!0},r.a.createElement(I.a,{disableTypography:!0},r.a.createElement(S.a,{id:"standard-name",label:"Name",className:s.textField,value:i,onChange:function(e){return o(e.target.value)},margin:"normal"}),r.a.createElement(O.a,{onClick:function(){return n(!0)}},r.a.createElement(C.a,null),"\xa0 Save"),u,r.a.createElement(x.a,{className:s.closeButton,onClick:function(){return n(!1)}},r.a.createElement(E.a,null))),r.a.createElement(N.a,null,r.a.createElement("div",{className:"editor"},r.a.createElement(w.a,{language:"json",value:a,height:400,onChange:c,editorDidMount:function(e){e.focus()},editorWillMount:function(e){e.languages.json.jsonDefaults.setDiagnosticsOptions({allowComments:!1,enableSchemaRequest:!0,schemas:R,validate:!0})},options:{automaticLayout:!0,cursorBlinking:"smooth",folding:!0,lineNumbersMinChars:4,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on"}})),r.a.createElement("span",{className:s.errorMessage},null!==l?r.a.createElement(r.a.Fragment,null,l," \xa0"):null)))},_=[{$schema:"https://vega.github.io/schema/vega-lite/v3.json",data:{url:"https://vega.github.io/editor/data/cars.json"},mark:"point",encoding:{x:{field:"Horsepower",type:"quantitative"},y:{field:"Miles_per_Gallon",type:"quantitative"}}},{$schema:"https://vega.github.io/schema/vega-lite/v3.json",data:{url:"https://vega.github.io/editor/data/cars.json"},mark:{type:"errorband",extent:"stdev"},encoding:{y:{field:"Miles_per_Gallon",type:"quantitative"}}},{$schema:"https://vega.github.io/schema/vega-lite/v3.json",data:{url:"https://vega.github.io/editor/data/population.json"},transform:[{filter:"datum.year == 2000"}],mark:"bar",encoding:{y:{field:"age",type:"ordinal",scale:{rangeStep:17}},x:{aggregate:"sum",field:"people",type:"quantitative",axis:{title:"population"}}}}],B=function(e){try{var t=JSON.parse(e);return"data"in t&&("url"in t.data||"values"in t.data)?(b.compile(t),{tag:"success",value:t}):g("data field must exist and must be url.")}catch(n){return g(n.message)}},M=function(e){var t=e.showModal,n=e.setShowModal,c=e.value,i=e.setValue,o=e.alias,l=e.setAlias,u=e.onSuccess,f=Object(a.useState)(""),p=Object(s.a)(f,2),m=p[0],v=p[1],h=_.map(function(e,t){return r.a.createElement(O.a,{key:t,onClick:function(){return i(d()(e))}},"Example ",t+1)});return r.a.createElement(F,{isOpen:t,onClose:function(e){if(!e)return v(""),void n(!1);var t=B(c);switch(t.tag){case"success":return v(""),u(o,t.value),void n(!1);case"failure":return void v(t.value)}},value:c,onChange:function(e){i(e);var t=B(e);switch(t.tag){case"success":v("");break;case"failure":v(t.value)}},alias:o,setAlias:l,errorMsg:m,extras:h})},A=n(562),T=Object(o.a)(function(e){return{keyColumn:{textAlign:"right"}}}),L=function(e){var t=e.table,n=e.children,a=T(),c=r.a.createElement("table",null,r.a.createElement("tbody",null,t.map(function(e){var t=Object(s.a)(e,2),n=t[0],c=t[1];return r.a.createElement("tr",{key:n},r.a.createElement("td",{className:a.keyColumn},r.a.createElement("strong",null,n),":"),r.a.createElement("td",null,c))})));return r.a.createElement(A.a,{placement:"top",title:c},n)},W=n(542),z=n(506),U=n(155),H=n(248),$=n(347),G=r.a.memo($.a,function(e,t){var n=e.spec,a=Object(U.a)(e,["spec"]),r=t.spec,c=Object(U.a)(t,["spec"]);return Object(l.b)(a,c)&&H.a.isSameSpec(n,r)}),q=Object(o.a)(function(e){return{wrapper:{height:150,"&::after":{display:"block",position:"absolute",width:144,backgroundImage:"linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(0, 0, 0, 0.5))",height:"75%",content:"''",bottom:0,alignSelf:"center"}},image:{overflow:"hidden",height:150,width:144},preview:{position:"relative",userSelect:"none",width:150,marginTop:5,marginLeft:"auto",marginRight:"auto",border:3,borderColor:function(e){return e?"#ed553b":"lightgrey"},borderStyle:"solid","&:hover":{borderColor:function(e){return e?"#ed553b":"darkgrey"}},"&:active":{borderColor:"grey"},cursor:"pointer"},center:{position:"absolute",left:"50%",transform:"translate(-50%, 0)"},top:{position:"absolute",right:0,top:0,"& button":{marginRight:e.spacing(1),marginTop:e.spacing(1)}},bottom:{bottom:10,color:"white"}}}),J=function(e){var t,n,c=e.spec,i=Object(a.useState)(!1),o=Object(s.a)(i,2),u=o[0],f=o[1],p=Object(a.useState)(""),v=Object(s.a)(p,2),b=v[0],O=v[1],g=Object(a.useState)(""),y=Object(s.a)(g,2),w=y[0],j=y[1],E=Object(a.useState)(!1),k=Object(s.a)(E,2),C=k[0],S=k[1],x=Object(l.c)(),V=Object(l.d)(function(e){return e.current.operands.includes(c.id)}),I=q(V),N=c.spec.mark?[["Data URL",(n=c.spec.data,"url"in n?n.url:"Embeded data")],["Mark Type",(t=c.spec.mark,"string"===typeof t?t:t.type)]]:[["Composite View",Q(c.spec)]];return r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,{disableGutters:!0,className:I.preview,onClick:function(){C||x({type:"select-operand",operand:c.id})}},r.a.createElement(L,{table:N},r.a.createElement("div",{className:I.wrapper},r.a.createElement("div",{className:I.image},r.a.createElement(G,{spec:c.spec,width:150,height:150})))),r.a.createElement("div",{className:I.top},r.a.createElement(W.a,{size:"small",color:"primary",onClick:function(){O(d()(c.spec)),j(c.alias),f(!0)}},r.a.createElement(h.a,null)),r.a.createElement(W.a,{size:"small",color:"secondary",onClick:function(){x({type:"delete-spec",id:c.id})},onMouseEnter:function(){return S(!0)},onMouseLeave:function(){return S(!1)}},r.a.createElement(m.a,null))),r.a.createElement("div",{className:I.center+" "+I.bottom},c.alias)),r.a.createElement(M,{showModal:u,setShowModal:f,onSuccess:function(e,t){x({type:"modify-spec",json:t,alias:e,id:c.id})},value:b,setValue:O,alias:w,setAlias:j}))};function Q(e){return e.layer?"Layer View":e.concat||e.hconcat||e.vconcat?"Concat View":e.spec?e.facet?"Facet View":"Repeat View":"Undefined"}var X=Object(o.a)(function(e){return{list:{overflowY:"auto",overflowX:"hidden",flexGrow:1,paddingTop:0,paddingBottom:0,display:"flex",flexDirection:"column",alignContent:"center"}}}),Y=function(){var e=X(),t=Object(l.d)(function(e){return e.current.specs});return r.a.createElement(u.a,{className:e.list},t.map(function(e){return r.a.createElement(J,{key:e.id,spec:e})}))},K=n(334),Z=n.n(K),ee=Object(o.a)(function(e){return{button:{marginBottom:e.spacing(1)}}}),te=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(""),o=Object(s.a)(i,2),u=o[0],f=o[1],d=Object(a.useState)(""),p=Object(s.a)(d,2),m=p[0],v=p[1],h=Object(l.c)(),b=ee();return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{onClick:function(){f(""),v("Untitled"),c(!0)},className:b.button},r.a.createElement(Z.a,null)," \xa0 New Spec"),r.a.createElement(M,{showModal:n,setShowModal:c,onSuccess:function(e,t){h({type:"add-spec",json:t,alias:e})},value:u,setValue:f,alias:m,setAlias:v}))},ne=n(335),ae=n.n(ne)()(function(e){return{main:{padding:10,border:3,borderColor:function(e){return e.isActive?"#ed553b":"lightgrey"},borderStyle:"solid","&:hover":{borderColor:function(e){return e.isActive?"#ed553b":e.toHover?"lightgrey":"darkgrey"}},"&:active":{borderColor:"grey"},cursor:"pointer",backgroundColor:"white",display:"flex",justifyContent:"flex-start",alignItems:"flex-start"}}}),re=function(e){return function(t){var n=t.view,c=t.setIsHovering,i=n.id,o=Object(l.c)(),u=Object(a.useState)(!1),f=Object(s.a)(u,2),d=f[0],p=f[1],m=Object(l.d)(function(e){return e.current.operands.includes(i)}),v=ae({isActive:m,toHover:d});return r.a.createElement("div",{className:v.main,onClick:function(){d||o({type:"select-operand",operand:i})},onMouseEnter:function(){return c&&c(!0)},onMouseLeave:function(){return c&&c(!1)}},r.a.createElement(e,{view:n,setIsHovering:p}))}},ce=re(function(e){var t=e.view;return r.a.createElement(G,{spec:t.export()})}),ie=re(function(e){var t=e.view;return r.a.createElement(G,{spec:t.export()})}),oe=re(function(e){var t=e.view,n=e.setIsHovering,a=t,c=a.getSubViews();return r.a.createElement("div",{style:{display:"flex",flexDirection:"h"===a.getOrient()?"row":"column"}},c.map(function(e){return se(e,n)}))}),le=re(function(e){var t=e.view;return r.a.createElement(G,{spec:t.export()})}),ue=re(function(e){var t=e.view;return r.a.createElement(G,{spec:t.export()})}),se=function(e,t){var n=function(){switch(e.type){case"unit":return ce;case"layer":return ie;case"concat":return oe;case"facet":return le;case"repeat":return ue;default:throw new Error("".concat(e.type," view has not been implemented"))}}();return r.a.createElement(n,{view:e,setIsHovering:t})},fe=Object(o.a)(function(e){return{main:{backgroundColor:e.palette.grey[200],marginTop:e.spacing(1),flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},emptyView:{color:"darkgrey",fontSize:20}}}),de=function(){var e=fe(),t=Object(l.d)(function(e){return e.current.tree});return r.a.createElement("div",{className:e.main},t?se(t):r.a.createElement("div",{className:e.emptyView},"Empty View"))},pe=n(341),me=n.n(pe),ve=n(342),he=n.n(ve),be=n(547),Oe=n(221),ge=n.n(Oe),ye=n(247),we=n.n(ye),je=n(65),Ee=n(17),ke=n(19),Ce=n(20),Se=n(31),xe=n(29),Ve=n(32),Ie=n(28),Ne=n(112),Pe=n(343);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(n,!0).forEach(function(t){Object(Ie.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Fe(e,t,n){if(!(t in e&&n in e))throw new Error("from (=".concat(t,") or to (=").concat(n,") is out of arr bound (=[0,").concat(e.length-1,"])"));var a=e[t];if(t<n)for(var r=t;r<n;r++)e[r]=e[r+1];else for(var c=t;c>n;c--)e[c]=e[c-1];e[n]=a}function _e(e){var t=function e(t){if(Object(je.f)(t))return t.data?[t.data]:[];if(Object(je.e)(t)||Object(je.b)(t))return[].concat(Object(Ee.a)(e(t.spec)),Object(Ee.a)(t.data?[t.data]:[]));var n=[];return Object(je.d)(t)?n=t.layer:Object(Ne.b)(t)?n=t.concat:Object(Ne.c)(t)?n=t.hconcat:Object(Ne.d)(t)&&(n=t.vconcat),[].concat(Object(Ee.a)(n.map(function(t){return e(t)}).flat()),Object(Ee.a)(t.data?[t.data]:[]))}(e);if(0===t.length)return!0;var n=t[0],a=!0,r=!1,c=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=i.value;if(!Pe.a(l,n))return!0}}catch(u){r=!0,c=u}finally{try{a||null==o.return||o.return()}finally{if(r)throw c}}return!1}function Be(e){return function e(t){if(Object(je.f)(t)){var n=t.data,a=Object(U.a)(t,["data"]);return{data:n?[n]:[],spec:a}}if(Object(je.e)(t)||Object(je.b)(t)){var r=t.data,c=e(t.spec),i=c.data,o=c.spec;return t.spec=o,{data:[].concat(Object(Ee.a)(r?[r]:[]),Object(Ee.a)(i)),spec:t}}var l="";Object(je.d)(t)?l="layer":Object(Ne.b)(t)?l="concat":Object(Ne.c)(t)?l="hconcat":Object(Ne.d)(t)&&(l="vconcat");var u=t.data;var s=u?[u]:[];for(var f=0;f<t[l].length;f++){var d=e(t[l][f]),p=d.data,m=d.spec;s.push.apply(s,Object(Ee.a)(p)),t[l][f]=m}return{data:s,spec:t}}(Te(e))}function Me(e,t,n){if(e===n.id)return{parent:null,view:n};var a=!0,r=!1,c=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=i.value.findView(e);if(null!==l)return null!==l.parent?l:Re({},l,{parent:n})}}catch(u){r=!0,c=u}finally{try{a||null==o.return||o.return()}finally{if(r)throw c}}return null}function Ae(e,t,n){for(var a=0;a<t.length;a++)if(t[a].id===n)return t[a]=e,!0;return!1}function Te(e){return JSON.parse(JSON.stringify(e))}var Le=1,We=function(){function e(t){Object(ke.a)(this,e),this._id=void 0,this._type=void 0,this._id=Le++,this._type=t}return Object(Ce.a)(e,[{key:"type",get:function(){return this._type}},{key:"id",get:function(){return this._id}}]),e}(),ze=function(e){function t(){return Object(ke.a)(this,t),Object(Se.a)(this,Object(xe.a)(t).apply(this,arguments))}return Object(Ve.a)(t,e),t}(We),Ue=function(e){function t(e){var n;return Object(ke.a)(this,t),(n=Object(Se.a)(this,Object(xe.a)(t).call(this,"unit"))).spec=void 0,n.spec=e,n}return Object(Ve.a)(t,e),Object(Ce.a)(t,[{key:"edit",value:function(e){this.spec=e}},{key:"export",value:function(){return Te(this.spec)}},{key:"clone",value:function(){var e=new t(this.spec);return e._id=this._id,e}},{key:"deepClone",value:function(){var e=new t(Te(this.spec));return e._id=this._id,e}},{key:"findView",value:function(e){return this._id===e?{parent:null,view:this}:null}},{key:"replaceChild",value:function(e,t){throw new Error("UnitView cannot replace child")}},{key:"getEncoding",value:function(){return this.spec.encoding}}]),t}(We),He=function(e){function t(){var e;return Object(ke.a)(this,t),(e=Object(Se.a)(this,Object(xe.a)(t).call(this,"layer"))).layer=void 0,e.layer=[],e}return Object(Ve.a)(t,e),Object(Ce.a)(t,[{key:"export",value:function(){return{layer:this.layer.map(function(e){return e.export()})}}},{key:"append",value:function(e){this.layer.push(e)}},{key:"prepend",value:function(e){this.layer.unshift(e)}},{key:"remove",value:function(e){this.layer.splice(e,1)}},{key:"isCompatible",value:function(e){var t=e.export();return!t.spec&&!t.concat&&!t.hconcat&&!t.vconcat}},{key:"rearrange",value:function(e,t){Fe(this.layer,e,t)}},{key:"clone",value:function(){var e=new t;return e._id=this._id,e.layer=Object(Ee.a)(this.layer),e}},{key:"deepClone",value:function(){var e=new t;return e._id=this._id,e.layer=this.layer.map(function(e){return e.deepClone()}),e}},{key:"findView",value:function(e){return Me(e,this.layer,this)}},{key:"replaceChild",value:function(e,t){return Ae(e,this.layer,t)}},{key:"getEncoding",value:function(){return this.layer.map(function(e){return e.getEncoding()})}},{key:"getSubViews",value:function(){return Object(Ee.a)(this.layer)}}]),t}(ze);function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Ge=function(e,t){return function(n,a){e(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(n,!0).forEach(function(t){Object(Ie.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:"operate",operands:t,operator:n},a?{extra:a}:{}))}},qe=n(346),Je=n(543),Qe=Object(o.a)(function(){return{buttonNormal:{},buttonWarn:{"&:hover":{backgroundColor:"#ffd800"}},error:{width:22,height:22,color:"#ed1c1c"}}}),Xe=function(e){var t=e.navBarOperands,n=e.mainViewOperands,c=Qe(),i=Object(l.d)(function(e){return e.current.operands}),o=Object(l.d)(function(e){return e.current.tree}),u=Object(l.d)(function(e){return e.current.specs}),f=Ge(Object(l.c)(),i),d=Object(a.useState)(null),p=Object(s.a)(d,2),m=p[0],v=p[1],h=function(e,t,n,a){if(1!==e.length||1!==t.length||0!==n.filter(function(e){return t.includes(e.id)&&!Object(je.f)(e.spec)&&!Object(je.d)(e.spec)}).length)return!0;var r=a.findView(e[0]);return null===r||!(r.view instanceof He)&&!Object(je.f)(r.view.export())&&!Object(je.d)(r.view.export())}(n,t,u,o),b=function(e,t,n,a,r){if(e)return!1;var c=[],i=!0,o=!1,l=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var f=u.value;n.includes(f.id)&&c.push(new Ue(f.spec).getEncoding())}}catch(C){o=!0,l=C}finally{try{i||null==s.return||s.return()}finally{if(o)throw l}}var d=r.findView(a[0]).view,p=[];d instanceof Ue?p=[d.getEncoding()]:d instanceof He&&(p=d.getEncoding());var m={},v={},h=!0,b=!1,O=void 0;try{for(var g,y=c.concat(p)[Symbol.iterator]();!(h=(g=y.next()).done);h=!0)for(var w=g.value,j=0,E=Object.keys(w);j<E.length;j++){var k=E[j];if(k in m&&(m[k]!==w[k].field||w[k].type&&v[k]!==w[k].type))return!0;m[k]=w[k].field,v[k]=w[k].type}}catch(C){b=!0,O=C}finally{try{h||null==y.return||y.return()}finally{if(b)throw O}}return!1}(h,u,t,n,o),g=function(e){v(e.currentTarget)},y=function(e){return function(){w(),f("layer",e)}},w=function(){v(null)};return r.a.createElement(r.a.Fragment,null,b?r.a.createElement(L,{table:[["Warning","Operands have different encoding(s)"]]},r.a.createElement(O.a,{onClick:g,className:c.buttonWarn,"aria-owns":m?"layer-menu":void 0,"aria-haspopup":"true"},r.a.createElement(ge.a,{className:c.error})," \xa0 Layer",r.a.createElement(we.a,null))):r.a.createElement(O.a,{onClick:g,disabled:h,className:c.buttonNormal,"aria-owns":m?"layer-menu":void 0,"aria-haspopup":"true"},"Layer",r.a.createElement(we.a,null)),r.a.createElement(qe.a,{id:"layer-menu",anchorEl:m,open:Boolean(m),onClose:w,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement(Je.a,{onClick:y("prepend")},"Under"),r.a.createElement(Je.a,{onClick:y("append")},"Over")))};var Ye=function(e){var t=e.navBarOperands,n=e.mainViewOperands,c=Object(l.d)(function(e){return e.current.operands}),i=Ge(Object(l.c)(),c),o=Object(a.useState)(null),u=Object(s.a)(o,2),f=u[0],d=u[1],p=function(e,t){return function(){m(),i("concat",{option:e,orient:t})}},m=function(){d(null)},v=1!==n.length||1!==t.length;return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{onClick:function(e){d(e.currentTarget)},disabled:v,"aria-owns":f?"layer-menu":void 0,"aria-haspopup":"true"},"Concat",r.a.createElement(we.a,null)),r.a.createElement(qe.a,{id:"layer-menu",anchorEl:f,open:Boolean(f),onClose:m,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement(Je.a,{onClick:p("prepend","h")},"On Left"),r.a.createElement(Je.a,{onClick:p("append","h")},"On Right"),r.a.createElement(Je.a,{onClick:p("prepend","v")},"On Top"),r.a.createElement(Je.a,{onClick:p("append","v")},"On Bottom")))},Ke=n(557),Ze=n(544),et=n(545),tt=n(337),nt=n.n(tt),at=n(336),rt=n.n(at),ct=n(288);function it(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(n,!0).forEach(function(t){Object(Ie.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ut=function(e){function t(e,n){var a;return Object(ke.a)(this,t),(a=Object(Se.a)(this,Object(xe.a)(t).call(this,"repeat"))).repeatInfo=void 0,a.view=void 0,a.repeatInfo=n,a.view=e,a}return Object(Ve.a)(t,e),Object(Ce.a)(t,[{key:"export",value:function(){return{repeat:this.repeatInfo.export(),spec:dt(this.view.export(),this.repeatInfo)}}},{key:"addAxis",value:function(e,t){this.repeatInfo.addAxis(e,t)}},{key:"removeAxis",value:function(e){this.repeatInfo.removeAxis(e)}},{key:"append",value:function(e,t){this.repeatInfo.isRepeating(t)&&this.repeatInfo[t].push(e)}},{key:"prepend",value:function(e,t){this.repeatInfo.isRepeating(t)&&this.repeatInfo[t].unshift(e)}},{key:"remove",value:function(e,t){this.repeatInfo.remove(e,t)}},{key:"isCompatible",value:function(e){return!0}},{key:"rearrange",value:function(e,t,n){this.repeatInfo.isRepeating(n)&&Fe(this.repeatInfo[n],e,t)}},{key:"clone",value:function(){var e=new t(this.view,this.repeatInfo);return e._id=this._id,e}},{key:"deepClone",value:function(){var e=new t(this.view.deepClone(),this.repeatInfo.clone());return e._id=this._id,e}},{key:"findView",value:function(e){return Me(e,[this.view],this)}},{key:"replaceChild",value:function(e,t){return this.view.id===t&&(this.view=e,!0)}},{key:"getSubViews",value:function(){return[this.view]}},{key:"changeInfo",value:function(e){this.repeatInfo=e}},{key:"getInfo",value:function(){return this.repeatInfo.clone()}}]),t}(ze),st=function(){function e(t,n,a){Object(ke.a)(this,e),this.row=void 0,this.column=void 0,this.rowChannel=void 0,this.columnChannel=void 0,this.row=a.rowChannel?t:[],this.column=a.columnChannel?n:[],this.rowChannel=a.rowChannel,this.columnChannel=a.columnChannel}return Object(Ce.a)(e,[{key:"repeat",value:function(e,t){this.isRepeating(e)||(this[e]=[],this["".concat(e,"Channel")]=t)}},{key:"isRepeating",value:function(e){return!!this["".concat(e,"Channel")]}},{key:"export",value:function(){return lt({},this.isRepeating("row")?{row:Te(this.row)}:{},{},this.isRepeating("column")?{column:Te(this.column)}:{})}},{key:"remove",value:function(e,t){this[t].splice(e,1)}},{key:"addAxis",value:function(e,t){this[t]=[],this["".concat(t,"Channel")]=e}},{key:"removeAxis",value:function(e){this[e]=[],this["".concat(e,"Channel")]=void 0}},{key:"getChannelInfo",value:function(){return lt({},this.rowChannel?{rowChannel:this.rowChannel}:{},{},this.columnChannel?{columnChannel:this.columnChannel}:{})}},{key:"clone",value:function(){return new e(this.row,this.column,lt({},this.rowChannel?{rowChannel:this.rowChannel}:{},{},this.columnChannel?{columnChannel:this.columnChannel}:{}))}}]),e}(),ft=["layer","concat","hconcat","vconcat","spec"];function dt(e,t){var n=void 0;ft.forEach(function(t){e[t]&&(n=t)});var a=Te(e),r=a[n||"$invalid-vl-field$"],c=Object(U.a)(a,[n||"$invalid-vl-field$"].map(it));return n&&(c[n]=r.map(function(e){return dt(e,t)})),c.encoding&&function(e,t){t.rowChannel&&e[t.rowChannel]&&(e[t.rowChannel].field={repeat:"row"});t.columnChannel&&e[t.columnChannel]&&(e[t.columnChannel].field={repeat:"column"})}(c.encoding,t),c}var pt=Object(ct.a)(function(){return{channel:{width:80},fieldText:{minWidth:100},fieldTexts:{display:"flex",flexDirection:"column",width:200},addAndRemove:{top:10,width:40,height:40},checkBox:{top:10,width:30,height:30},axisConfig:{display:"flex",flexDirection:"row",alignContent:"flex-start"}}}),mt=function(e){var t=e.isOpen,n=e.onClose,c=e.currentRepeat,i=pt(),o=Object(a.useState)(!1),u=Object(s.a)(o,2),f=u[0],d=u[1],p=Object(a.useState)(!1),m=Object(s.a)(p,2),v=m[0],h=m[1],b=Object(a.useState)([""]),g=Object(s.a)(b,2),y=g[0],w=g[1],j=Object(a.useState)(""),k=Object(s.a)(j,2),C=k[0],P=k[1],D=Object(a.useState)([""]),R=Object(s.a)(D,2),F=R[0],_=R[1],B=Object(a.useState)(""),M=Object(s.a)(B,2),A=M[0],T=M[1],L=Object(l.d)(function(e){return e.current.operands}),W=Object(l.c)(),z=Ge(W,L),U=function(e,t,n){return function(a){var r=Object(Ee.a)(e);r[n]=a.target.value,t(r)}},H=function(e,t,n,a,c,o,l){return r.a.createElement("div",{className:i.axisConfig},r.a.createElement(Ke.a,{checked:e,onChange:function(){return t(!e)},className:i.checkBox}),r.a.createElement(S.a,{label:"Channel",value:n,onChange:function(e){return a(e.target.value)},className:i.channel}),"\xa0 \xa0",r.a.createElement("div",{className:i.fieldTexts},c.map(function(e,t){return r.a.createElement(S.a,{label:"".concat(l," Field"),value:e,onChange:U(c,o,t),className:i.fieldText})})),"\xa0 \xa0",r.a.createElement(x.a,{onClick:function(){return o([].concat(Object(Ee.a)(c),[""]))},className:i.addAndRemove},r.a.createElement(rt.a,null)),r.a.createElement(x.a,{onClick:function(){if(c.length>1){var e=Object(Ee.a)(c);e.splice(-1),o(e)}},className:i.addAndRemove},r.a.createElement(nt.a,null)))};return r.a.createElement(V.a,{open:t,onEntering:function(){d(!1),h(!1),w([""]),P(""),_([""]),T(""),c&&(c.isRepeating("row")&&(d(!0),w(c.row),P(c.rowChannel)),c.isRepeating("column")&&(h(!0),_(c.column),T(c.columnChannel)))},"aria-labelledby":"repeat-dialog-title"},r.a.createElement(I.a,{id:"repeat-dialog-title"},r.a.createElement(r.a.Fragment,null,"Repeat"),r.a.createElement(x.a,{onClick:n,style:{right:10,top:7,position:"absolute"}},r.a.createElement(E.a,null))),r.a.createElement(N.a,null,r.a.createElement(Ze.a,null,"Choose Field(s) and Encoding Channel(s) to repeat."),H(f,d,C,P,y,w,"Row"),H(v,h,A,T,F,_,"Column")),r.a.createElement(et.a,null,c?r.a.createElement(O.a,{onClick:function(){W({type:"decompose",operand:L[0]}),n()},color:"secondary"},"Decompose"):r.a.createElement(r.a.Fragment,null),r.a.createElement(O.a,{onClick:function(){var e=new st(y,F,{rowChannel:C,columnChannel:A});c?W({type:"modify-info",operand:L[0],info:e}):z("repeat",e),n()},autoFocus:!0,disabled:!(f&&0!==y.length&&""!==C)&&!(v&&0!==F.length&&""!==A)||f&&(0===y.length||""===C)||v&&(0===F.length||""===A)},"Repeat")))},vt=function(e){var t=e.navBarOperands,n=e.mainViewOperands,c=e.tree,i=qt(),o=Object(a.useState)(!1),l=Object(s.a)(o,2),u=l[0],f=l[1],d=1!==n.length||t.length>0,p=!d&&_e(c.findView(n[0]).view.export());return r.a.createElement(r.a.Fragment,null,p?r.a.createElement(L,{table:[["Warning","Not all views are using the same data source"]]},r.a.createElement(O.a,{onClick:function(){return f(!0)},className:i.buttonWarn},r.a.createElement(ge.a,{className:i.error})," \xa0 Repeat")):r.a.createElement(O.a,{onClick:function(){return f(!0)},disabled:d,className:i.buttonNormal},"Repeat"),r.a.createElement(mt,{isOpen:u,onClose:function(){return f(!1)}}))};function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(n,!0).forEach(function(t){Object(Ie.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ot=function(e){function t(e,n){var a;return Object(ke.a)(this,t),(a=Object(Se.a)(this,Object(xe.a)(t).call(this,"facet"))).view=void 0,a.facetInfo=void 0,a.facetInfo=n,a.view=e,a}return Object(Ve.a)(t,e),Object(Ce.a)(t,[{key:"export",value:function(){var e=Be(this.view.export()),t=e.data,n=Object(U.a)(e,["data"]);return bt({data:t[0],facet:this.facetInfo.export()},n)}},{key:"append",value:function(e,t){this.facetInfo.column?this.facetInfo.row||(this.facetInfo.row=t):this.facetInfo.column=t}},{key:"prepend",value:function(){throw new Error("prepend is not supported for FacetView")}},{key:"remove",value:function(e,t){this.facetInfo.remove(t)}},{key:"isCompatible",value:function(e){return!0}},{key:"rearrange",value:function(){this.facetInfo.row&&this.facetInfo.column&&this.facetInfo.swapAxis()}},{key:"clone",value:function(){var e=new t(this.view,this.facetInfo);return e._id=this._id,e}},{key:"deepClone",value:function(){var e=new t(this.view.deepClone(),this.facetInfo.clone());return e._id=this._id,e}},{key:"findView",value:function(e){return Me(e,[this.view],this)}},{key:"replaceChild",value:function(e,t){return this.view.id===t&&(this.view=e,!0)}},{key:"getSubViews",value:function(){return[this.view]}},{key:"changeInfo",value:function(e){this.facetInfo=e}},{key:"getInfo",value:function(){return this.facetInfo.clone()}}]),t}(ze),gt=function(){function e(t){Object(ke.a)(this,e),this.row=void 0,this.column=void 0,this.row=t.row,this.column=t.column}return Object(Ce.a)(e,[{key:"export",value:function(){return bt({},this.row?{row:this.row}:{},{},this.column?{column:this.column}:{})}},{key:"swapAxis",value:function(){var e=[this.column,this.row];this.row=e[0],this.column=e[1]}},{key:"remove",value:function(e){this[e]=void 0}},{key:"clone",value:function(){return new e(bt({},this.row?{row:Te(this.row)}:{},{},this.column?{column:Te(this.column)}:{}))}}]),e}(),yt=n(537),wt=n(561),jt=n(555);function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var kt=Object(ct.a)(function(){return{typeSelector:{minWidth:60},checkBox:{top:10}}}),Ct=function(e){var t=e.isOpen,n=e.onClose,c=e.currentFacet,i=kt(),o=Object(a.useState)(!1),u=Object(s.a)(o,2),f=u[0],d=u[1],p=Object(a.useState)(!1),m=Object(s.a)(p,2),v=m[0],h=m[1],b=Object(a.useState)(""),g=Object(s.a)(b,2),y=g[0],w=g[1],j=Object(a.useState)(""),k=Object(s.a)(j,2),C=k[0],P=k[1],D=Object(a.useState)(""),R=Object(s.a)(D,2),F=R[0],_=R[1],B=Object(a.useState)(""),M=Object(s.a)(B,2),A=M[0],T=M[1],L=Object(l.d)(function(e){return e.current.operands}),W=Object(l.c)(),z=Ge(W,L),U=function(e,t,n,a,c,o,l){return r.a.createElement("div",null,r.a.createElement(Ke.a,{checked:e,onChange:function(){return t(!e)},className:i.checkBox}),r.a.createElement(S.a,{label:"".concat(l," Field"),value:n,onChange:function(e){return a(e.target.value)}}),"\xa0 \xa0",r.a.createElement(yt.a,null,r.a.createElement(wt.a,{htmlFor:"row-type"},"Type"),r.a.createElement(jt.a,{value:c,onChange:function(e){return o(e.target.value)},inputProps:{name:"type",id:"row-type"},className:i.typeSelector},r.a.createElement(Je.a,{value:"nominal"},"Nominal"),r.a.createElement(Je.a,{value:"ordinal"},"Ordinal"),r.a.createElement(Je.a,{value:"quantitative"},"Quantitative"),r.a.createElement(Je.a,{value:"temporal"},"Temporal"))))};return r.a.createElement(V.a,{open:t,onEntering:function(){d(!1),h(!1),w(""),P(""),_(""),T(""),c&&(c.row&&(d(!0),w(c.row.field),P(c.row.type)),c.column&&(h(!0),_(c.column.field),T(c.column.type)))},"aria-labelledby":"facet-dialog-title"},r.a.createElement(I.a,{id:"facet-dialog-title"},r.a.createElement(r.a.Fragment,null,"Facet"),r.a.createElement(x.a,{onClick:n,style:{right:10,top:7,position:"absolute"}},r.a.createElement(E.a,null))),r.a.createElement(N.a,null,r.a.createElement(Ze.a,null,"Choose Field(s) and Type(s) to facet."),U(f,d,y,w,C,P,"Row"),U(v,h,F,_,A,T,"Column")),r.a.createElement(et.a,null,c?r.a.createElement(O.a,{onClick:function(){W({type:"decompose",operand:L[0]}),n()},color:"secondary"},"Decompose"):r.a.createElement(r.a.Fragment,null),r.a.createElement(O.a,{onClick:function(){var e=new gt(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(n,!0).forEach(function(t){Object(Ie.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},v?{column:{field:F,type:A}}:{},{},f?{row:{field:y,type:C}}:{}));c?W({type:"modify-info",operand:L[0],info:e}):z("facet",e),n()},autoFocus:!0,disabled:!(f&&""!==y&&""!==C)&&!(v&&""!==F&&""!==A)||f&&(""===y||""===C)||v&&(""===F||""===A)},"Facet")))},St=function(e){var t=e.navBarOperands,n=e.mainViewOperands,c=e.tree,i=qt(),o=Object(a.useState)(!1),l=Object(s.a)(o,2),u=l[0],f=l[1],d=1!==n.length||t.length>0,p=!d&&_e(c.findView(n[0]).view.export());return r.a.createElement(r.a.Fragment,null,p?r.a.createElement(L,{table:[["Warning","Not all views are using the same data source"]]},r.a.createElement(O.a,{onClick:function(){return f(!0)},className:i.buttonWarn},r.a.createElement(ge.a,{className:i.error})," \xa0 Facet")):r.a.createElement(O.a,{onClick:function(){return f(!0)},disabled:d,className:i.buttonNormal},"Facet"),r.a.createElement(Ct,{isOpen:u,onClose:function(){return f(!1)}}))},xt=function(e){var t=e.navBarOperands,n=e.mainViewOperands,a=Object(l.d)(function(e){return e.current.operands}),c=Object(l.d)(function(e){return e.current.tree}),i=Ge(Object(l.c)(),a),o=0===n.length&&null!==c||1!==t.length,u=null!==c;return r.a.createElement(O.a,{onClick:function(){return i(u?"replace":"place")},disabled:o},u?"Replace":"Place")},Vt=n(338),It=n.n(Vt),Nt=function(e){var t=e.tree,n=null===t;return r.a.createElement(O.a,{onClick:function(){var e=document.createElement("a"),n=new Blob([JSON.stringify(t.export(),null,2)],{type:"application/json"});e.href=URL.createObjectURL(n),e.download="visualization.json",document.body.appendChild(e),e.click()},color:"primary",disabled:n},r.a.createElement(It.a,null)," \xa0 Export")},Pt=n(546),Dt=n(339),Rt=n.n(Dt),Ft=n(340),_t=n.n(Ft),Bt=n(284),Mt=n.n(Bt),At=n(285),Tt=n.n(At),Lt=Object(o.a)(function(){return{preview:{border:3,borderColor:function(e){return e?"#ed553b":"lightgrey"},borderStyle:"solid","&:hover":{borderColor:function(e){return e?"#ed553b":"darkgrey"}},"&:active":{borderColor:"grey"},cursor:"pointer"}}}),Wt=function(e){var t=e.view,n=e.selectedSubViewId,a=e.setSelectedSubViewId,c=Lt(n===t.id);return r.a.createElement("div",{className:c.preview,onClick:function(){a(n!==t.id?t.id:null)}},r.a.createElement(G,{spec:t.export()}))},zt=Object(ct.a)(function(){return{views:{display:"flex",justifyContent:"center",flexDirection:function(e){return e?"row":"column"},alignItems:"center"},actions:{display:"flex",justifyContent:"space-between",flexDirection:"row",paddingLeft:20}}}),Ut=function(e){var t=e.isOpen,n=e.onClose,c=Object(a.useState)([]),i=Object(s.a)(c,2),o=i[0],u=i[1],f=Object(a.useState)("h"),d=Object(s.a)(f,2),p=d[0],m=d[1],v=Object(a.useState)({}),h=Object(s.a)(v,2),b=h[0],g=h[1],y=Object(a.useState)(null),w=Object(s.a)(y,2),j=w[0],k=w[1],C=zt("h"===p),S=Object(l.d)(function(e){return e.current.operands}),P=Object(l.d)(function(e){return e.current.tree}),D=Object(l.c)(),R=0===o.length;return r.a.createElement(V.a,{open:t,onEntering:function(){var e=P.findView(S[0]).view,t=e.getSubViews(),n={};t.forEach(function(e){n[e.id]=e}),g(n),u(t.map(function(e){return e.id})),m(e.getOrient()),k(null)},"aria-labelledby":"concat-dialog-title"},r.a.createElement(I.a,{id:"concat-dialog-title"},r.a.createElement(r.a.Fragment,null,"Concat"),r.a.createElement(x.a,{onClick:n,style:{right:10,top:7,position:"absolute"}},r.a.createElement(E.a,null))),r.a.createElement(N.a,null,r.a.createElement(Ze.a,null,"Rearrange or remove sub views. Or change concat orientation."),r.a.createElement("div",{className:C.views},o.map(function(e){return r.a.createElement(Wt,{view:b[e],selectedSubViewId:j,setSelectedSubViewId:k})}))),r.a.createElement(et.a,{className:C.actions},r.a.createElement("div",null,"v",r.a.createElement(Pt.a,{checked:"h"===p,onChange:function(e){m(e.target.checked?"h":"v")},color:"default",inputProps:{"aria-label":"checkbox with default color"}}),"h"),r.a.createElement("div",null,r.a.createElement(x.a,{disabled:null===j||j===o[0],onClick:function(){for(var e=1;e<o.length;e++)if(o[e]===j){var t=Object(Ee.a)(o);return t[e-1]=o[e],t[e]=o[e-1],void u(t)}}},"h"===p?r.a.createElement(Rt.a,null):r.a.createElement(Mt.a,null)),r.a.createElement(x.a,{disabled:null===j||j===o[o.length-1],onClick:function(){for(var e=0;e<o.length-1;e++)if(o[e]===j){var t=Object(Ee.a)(o);return t[e+1]=o[e],t[e]=o[e+1],void u(t)}}},"h"===p?r.a.createElement(_t.a,null):r.a.createElement(Tt.a,null))),r.a.createElement("div",null,r.a.createElement(O.a,{onClick:function(){u(o.filter(function(e){return e!==j})),k(null)},color:"secondary",disabled:null===j||o.length<=1},"Remove"),r.a.createElement(O.a,{onClick:function(){D({type:"rearrange-subview",operand:S[0],order:o,orient:p}),n()},autoFocus:!0,disabled:R},"Concat"))))},Ht=Object(ct.a)(function(){return{views:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},actions:{display:"flex",justifyContent:"space-between",flexDirection:"row",paddingLeft:20}}}),$t=function(e){var t=e.isOpen,n=e.onClose,c=Ht(),i=Object(a.useState)([]),o=Object(s.a)(i,2),u=o[0],f=o[1],d=Object(a.useState)({}),p=Object(s.a)(d,2),m=p[0],v=p[1],h=Object(a.useState)(null),b=Object(s.a)(h,2),g=b[0],y=b[1],w=Object(l.d)(function(e){return e.current.operands}),j=Object(l.d)(function(e){return e.current.tree}),k=Object(l.c)(),C=0===u.length;return r.a.createElement(V.a,{open:t,onEntering:function(){var e=j.findView(w[0]).view.getSubViews(),t={};e.forEach(function(e){t[e.id]=e}),v(t),f(e.map(function(e){return e.id})),y(null)},"aria-labelledby":"layer-dialog-title"},r.a.createElement(I.a,{id:"layer-dialog-title"},r.a.createElement(r.a.Fragment,null,"Layer"),r.a.createElement(x.a,{onClick:n,style:{right:10,top:7,position:"absolute"}},r.a.createElement(E.a,null))),r.a.createElement(N.a,null,r.a.createElement(Ze.a,null,"Rearrange or remove sub views."),r.a.createElement("div",{className:c.views},u.map(function(e){return r.a.createElement(Wt,{view:m[e],selectedSubViewId:g,setSelectedSubViewId:y})}))),r.a.createElement(et.a,{className:c.actions},r.a.createElement("div",null,r.a.createElement(x.a,{disabled:null===g||g===u[0],onClick:function(){for(var e=1;e<u.length;e++)if(u[e]===g){var t=Object(Ee.a)(u);return t[e-1]=u[e],t[e]=u[e-1],void f(t)}}},r.a.createElement(Mt.a,null)),r.a.createElement(x.a,{disabled:null===g||g===u[u.length-1],onClick:function(){for(var e=0;e<u.length-1;e++)if(u[e]===g){var t=Object(Ee.a)(u);return t[e+1]=u[e],t[e]=u[e+1],void f(t)}}},r.a.createElement(Tt.a,null))),r.a.createElement("div",null,r.a.createElement(O.a,{onClick:function(){f(u.filter(function(e){return e!==g})),y(null)},color:"secondary",disabled:null===g||u.length<=1},"Remove"),r.a.createElement(O.a,{onClick:function(){k({type:"rearrange-subview",operand:w[0],order:u}),n()},autoFocus:!0,disabled:C},"Layer"))))},Gt=function(e){var t=e.navBarOperands,n=e.mainViewOperands,c=e.tree,i=Object(a.useState)(!1),o=Object(s.a)(i,2),l=o[0],u=o[1],f=Object(a.useState)(!1),d=Object(s.a)(f,2),p=d[0],m=d[1],v=Object(a.useState)(!1),b=Object(s.a)(v,2),g=b[0],y=b[1],w=Object(a.useState)(!1),j=Object(s.a)(w,2),E=j[0],k=j[1],C=Object(a.useState)(null),S=Object(s.a)(C,2),x=S[0],V=S[1],I={layer:u,concat:m,repeat:y,facet:k,unit:function(){alert("Edit is currently not working for unit spec")}},N=1!==n.length||0!==t.length||null===c;return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{disabled:N,onClick:function(){var e=c.findView(n[0]).view;V(e),I[e.type](!0)}},r.a.createElement(h.a,null)," \xa0 Edit"),r.a.createElement($t,{isOpen:l,onClose:function(){return I.layer(!1)}}),r.a.createElement(Ut,{isOpen:p,onClose:function(){return I.concat(!1)}}),r.a.createElement(mt,{isOpen:g,onClose:function(){return I.repeat(!1)},currentRepeat:x instanceof ut?x.getInfo():void 0}),r.a.createElement(Ct,{isOpen:E,onClose:function(){return I.facet(!1)},currentFacet:x instanceof Ot?x.getInfo():void 0}))},qt=Object(o.a)(function(){return{buttonNormal:{},buttonWarn:{"&:hover":{backgroundColor:"#ffd800"}},error:{width:22,height:22,color:"#ed1c1c"}}}),Jt=function(){var e=Object(l.c)(),t=Object(l.d)(function(e){return e.current.operands}),n=Object(l.d)(function(e){return e.current.tree}),a=Object(l.d)(function(e){return 0===e.undoStack.length}),c=Object(l.d)(function(e){return 0===e.redoStack.length}),i=t.filter(function(e){return e<0}),o=t.filter(function(e){return e>0});return r.a.createElement(be.a,{container:!0,justify:"space-between"},r.a.createElement(be.a,{item:!0},r.a.createElement(Xe,{navBarOperands:i,mainViewOperands:o}),r.a.createElement(Ye,{navBarOperands:i,mainViewOperands:o}),r.a.createElement(vt,{navBarOperands:i,mainViewOperands:o,tree:n}),r.a.createElement(St,{navBarOperands:i,mainViewOperands:o,tree:n}),r.a.createElement(xt,{navBarOperands:i,mainViewOperands:o})),r.a.createElement(be.a,{item:!0},r.a.createElement(O.a,{onClick:function(){return e({type:"undo"})},disabled:a},r.a.createElement(me.a,null)," \xa0 Undo"),r.a.createElement(O.a,{onClick:function(){return e({type:"redo"})},disabled:c},r.a.createElement(he.a,null)," \xa0 Redo"),"\xa0 \xa0",r.a.createElement(Gt,{navBarOperands:i,mainViewOperands:o,tree:n}),"\xa0 \xa0",r.a.createElement(Nt,{tree:n})))},Qt=n(255),Xt=n(548),Yt=n(549),Kt=n(550),Zt=n(554),en=n(345),tn=n(552),nn=n(344),an=n(553),rn=n(551),cn=function(e){function t(e){var n;return Object(ke.a)(this,t),(n=Object(Se.a)(this,Object(xe.a)(t).call(this,"concat"))).concat=void 0,n.orient=void 0,n.concat=[],n.orient=e,n}return Object(Ve.a)(t,e),Object(Ce.a)(t,[{key:"export",value:function(){return Object(Ie.a)({},this.orient+"concat",this.concat.map(function(e){return e.export()}))}},{key:"append",value:function(e){this.concat.push(e)}},{key:"prepend",value:function(e){this.concat.unshift(e)}},{key:"remove",value:function(e){this.concat.splice(e,1)}},{key:"isCompatible",value:function(e){return!0}},{key:"rearrange",value:function(e,t){Fe(this.concat,e,t)}},{key:"clone",value:function(){var e=new t(this.orient);return e._id=this._id,e.concat=Object(Ee.a)(this.concat),e}},{key:"deepClone",value:function(){var e=new t(this.orient);return e._id=this._id,e.concat=this.concat.map(function(e){return e.deepClone()}),e}},{key:"findView",value:function(e){return Me(e,this.concat,this)}},{key:"replaceChild",value:function(e,t){return Ae(e,this.concat,t)}},{key:"getSubViews",value:function(){return Object(Ee.a)(this.concat)}},{key:"getOrient",value:function(){return this.orient}},{key:"changeOrientation",value:function(e){this.orient=e}}]),t}(ze);function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var ln=function(e,t){return{current:t(e.current),undoStack:Xt.a(e.current,e.undoStack),redoStack:[]}},un={current:{specs:[],lastSpecId:-1,operands:[],tree:null},undoStack:[],redoStack:[]},sn=Object(Qt.b)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:un,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"add-spec":return ln(e,function(e){var n=e.specs,a=e.lastSpecId,r=Object(U.a)(e,["specs","lastSpecId"]);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(n,!0).forEach(function(t){Object(Ie.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({specs:Yt.a({id:a,spec:t.json,alias:t.alias},n),lastSpecId:a-1},r)});case"modify-spec":return ln(e,Kt.a(Zt.a("specs"),en.a(function(e){return e.id===t.id?{id:t.id,spec:t.json,alias:t.alias}:e})));case"delete-spec":return ln(e,tn.a(Kt.a(Zt.a("specs"),nn.a(function(e){return e.id!==t.id})),Kt.a(Zt.a("operands"),function(e){return e.filter(function(e){return e!==t.id})})));case"undo":var n=e.current,a=e.undoStack,r=e.redoStack;return a.length>0?{redoStack:Xt.a(n,r),current:a[0],undoStack:a.slice(1)}:e;case"redo":var c=e.current,i=e.undoStack,o=e.redoStack;return o.length>0?{redoStack:o.slice(1),current:o[0],undoStack:Xt.a(c,i)}:e;case"select-operand":return ln(e,Kt.a(Zt.a("operands"),function(e){return e.includes(t.operand)?an.a([t.operand],e):Yt.a(t.operand,e.filter(function(e){return e*t.operand<0}))}));case"operate":return ln(e,tn.a(Kt.a(Zt.a("tree"),function(n){var a=function(t){return e.current.specs.find(function(e){return e.id===t}).spec},r=t.operands.filter(function(e){return e<0}),c=t.operands.filter(function(e){return e>0});if("place"===t.operator)return new Ue(a(r[0]));var i=n.deepClone(),o=i.findView(c[0]);if(null===o)throw new Error("Cannot find view in MainView with id=".concat(c[0]));var l=o.parent,u=o.view;switch(t.operator){case"layer":var s=new Ue(a(r[0])),f=u.id;if(u instanceof Ue){var d=new He;d.append(u),u=d}u[t.extra](s),l?l.replaceChild(u,f):i=u;break;case"concat":var p=new Ue(a(r[0])),m=u.id,v=t.extra,h=v.orient,b=v.option;if(!(u instanceof cn)||u.getOrient()!==h){var O=new cn(h);O.append(u),u=O}u[b](p),l?l.replaceChild(u,m):i=u;break;case"repeat":var g=new ut(u,t.extra);l?l.replaceChild(g,u.id):i=g;break;case"facet":var y=new Ot(u,t.extra);l?l.replaceChild(y,u.id):i=y;break;case"replace":var w=new Ue(a(r[0]));l?l.replaceChild(w,u.id):i=w;break;default:return function(e){throw new Error("Unexpected object: "+e)}(t.operator)}return i}),Kt.a(Zt.a("operands"),rn.a([]))));case"decompose":return ln(e,tn.a(Kt.a(Zt.a("tree"),function(e){var n=e.deepClone(),a=n.findView(t.operand),r=a.parent,c=a.view;if(c instanceof ze){var i=c.getSubViews(),o=Object(s.a)(i,1)[0];r?r.replaceChild(o,t.operand):n=o}return n}),Kt.a(Zt.a("operands"),rn.a([]))));case"modify-info":return ln(e,tn.a(Kt.a(Zt.a("tree"),function(e){var n=e.deepClone(),a=n.findView(t.operand).view;return a instanceof Ot?a.changeInfo(t.info):a instanceof ut&&a.changeInfo(t.info),n}),Kt.a(Zt.a("operands"),rn.a([]))));case"rearrange-subview":return ln(e,tn.a(Kt.a(Zt.a("tree"),function(e){var n=e.deepClone(),a=n.findView(t.operand),r=a.parent,c=a.view;if(c instanceof cn||c instanceof He){var i=c instanceof He?new He:new cn(t.orient?t.orient:"h"),o={};c.getSubViews().forEach(function(e){return o[e.id]=e}),t.order.forEach(function(e){e in o?i.append(o[e]):console.error("subViewId is not in subViewMap")}),r?r.replaceChild(i,t.operand):n=i}return n}),Kt.a(Zt.a("operands"),rn.a([]))));default:return e}}),fn=Object(o.a)(function(e){return{main:{backgroundColor:e.palette.grey[200],marginTop:e.spacing(1),flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},emptyView:{color:"darkgrey",fontSize:20}}}),dn=function(){var e=fn(),t=Object(a.useState)(!1),n=Object(s.a)(t,2),c=n[0],i=n[1],o=Object(l.d)(function(e){return e.current.tree}),u=Object(l.d)(function(e){return e.current.operands}).filter(function(e){return e>0}),f=!!o&&1===u.length&&o.findView(u[0]),d=!!f&&f.view;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:37}},"Inner View Navigator",r.a.createElement(Pt.a,{checked:c,onChange:function(e){return i(e.target.checked)}})),r.a.createElement("div",{className:e.main},d&&c?se(d instanceof ut||d instanceof Ot?d.getSubViews()[0]:d):r.a.createElement("div",{className:e.emptyView},c?"No View Selected":"Disabled")))},pn=Object(o.a)(function(e){return{root:{minHeight:540,display:"flex"},left:{height:"100%",display:"flex",flexDirection:"column",width:150,marginRight:e.spacing(1)},center:{flexGrow:1,display:"flex",flexDirection:"column"},right:{display:"flex",flexDirection:"column",minWidth:300,alignItems:"center"}}}),mn=function(){var e=pn();return r.a.createElement(l.a,{store:sn},r.a.createElement("div",{className:e.root},r.a.createElement("div",{className:e.left},r.a.createElement(te,null),r.a.createElement(Y,null)),r.a.createElement("div",{className:e.center},r.a.createElement(Jt,null),r.a.createElement(de,null)),"\xa0",r.a.createElement("div",{className:e.right},r.a.createElement(dn,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(mn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[364,1,2]]]);
//# sourceMappingURL=main.994c885d.chunk.js.map