(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{318:function(e,t,a){e.exports=a(451)},323:function(e,t,a){},451:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),o=a(76),i=a.n(o),c=(a(323),a(52)),l=a(496),u=a(500),s=a(231),d=a.n(s),p=a(304),m=a.n(p),f=a(303),v=a.n(f),h=a(261),g=a(501),b=function(e){return{tag:"failure",value:e}},y=a(297),w=a.n(y),E=a(300),j=a.n(E),k=a(299),O=a.n(k),C=a(511),S=a(502),x=a(516),I=a(517),N=a(503),M=a(283);!function e(t){if("object"===typeof t&&null!==t)for(var a in t.description&&(t.markdownDescription=t.description),t)t.hasOwnProperty(a)&&(t[a]=e(t[a]));return t}(M);var V=Object(l.a)(function(e){return{textField:{marginTop:e.spacing(0),marginBottom:e.spacing(4),width:300},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1)},errorMessage:{fontStyle:"italic",color:"red"}}}),T=[{schema:M,uri:"https://vega.github.io/schema/vega-lite/v3.json"}],B=function(e){var t=e.isOpen,a=e.onClose,n=e.value,o=e.onChange,i=e.alias,c=e.setAlias,l=e.errorMsg,u=e.extras,s=V();return r.a.createElement(x.a,{open:t,onClose:a,"aria-labelledby":"form-dialog-title",maxWidth:"lg",fullWidth:!0},r.a.createElement(I.a,{disableTypography:!0},r.a.createElement(C.a,{id:"standard-name",label:"Name",className:s.textField,value:i,onChange:function(e){return c(e.target.value)},margin:"normal"}),r.a.createElement(g.a,{onClick:function(){return a(!0)}},r.a.createElement(O.a,null),"\xa0 Save"),u,r.a.createElement(S.a,{className:s.closeButton,onClick:function(){return a(!1)}},r.a.createElement(j.a,null))),r.a.createElement(N.a,null,r.a.createElement("div",{className:"editor"},r.a.createElement(w.a,{language:"json",value:n,height:400,onChange:o,editorDidMount:function(e){e.focus()},editorWillMount:function(e){e.languages.json.jsonDefaults.setDiagnosticsOptions({allowComments:!1,enableSchemaRequest:!0,schemas:T,validate:!0})},options:{automaticLayout:!0,cursorBlinking:"smooth",folding:!0,lineNumbersMinChars:4,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on"}})),r.a.createElement("span",{className:s.errorMessage},null!==l?r.a.createElement(r.a.Fragment,null,l," \xa0"):null)))},D=[{$schema:"https://vega.github.io/schema/vega-lite/v3.json",data:{url:"https://vega.github.io/editor/data/cars.json"},mark:"point",encoding:{x:{field:"Horsepower",type:"quantitative"},y:{field:"Miles_per_Gallon",type:"quantitative"}}},{$schema:"https://vega.github.io/schema/vega-lite/v3.json",data:{url:"https://vega.github.io/editor/data/population.json"},transform:[{filter:"datum.year == 2000"}],mark:"bar",encoding:{y:{field:"age",type:"ordinal",scale:{rangeStep:17}},x:{aggregate:"sum",field:"people",type:"quantitative",axis:{title:"population"}}}}],R=function(e){try{var t=JSON.parse(e);return"data"in t&&("url"in t.data||"values"in t.data)?(h.a(t),{tag:"success",value:t}):b("data field must exist and must be url.")}catch(a){return b(a.message)}},L=function(e){var t=e.showModal,a=e.setShowModal,o=e.value,i=e.setValue,l=e.alias,u=e.setAlias,s=e.onSuccess,p=Object(n.useState)(""),m=Object(c.a)(p,2),f=m[0],v=m[1],h=D.map(function(e,t){return r.a.createElement(g.a,{key:t,onClick:function(){return i(d()(e))}},"Example ",t+1)});return r.a.createElement(B,{isOpen:t,onClose:function(e){if(!e)return v(""),void a(!1);var t=R(o);switch(t.tag){case"success":return v(""),s(l,t.value),void a(!1);case"failure":return void v(t.value)}},value:o,onChange:function(e){i(e);var t=R(e);switch(t.tag){case"success":v("");break;case"failure":v(t.value)}},alias:l,setAlias:u,errorMsg:f,extras:h})},A=a(518),F=Object(l.a)(function(e){return{keyColumn:{textAlign:"right"}}}),W=function(e){var t=e.table,a=e.children,n=F(),o=r.a.createElement("table",null,r.a.createElement("tbody",null,t.map(function(e){var t=Object(c.a)(e,2),a=t[0],o=t[1];return r.a.createElement("tr",{key:a},r.a.createElement("td",{className:n.keyColumn},r.a.createElement("strong",null,a),":"),r.a.createElement("td",null,o))})));return r.a.createElement(A.a,{placement:"top",title:o},a)},G=a(505),J=a(504),q=r.a.createContext(null),U=a(224),P=a(302),$=a.n(P),z=a(222),H=a(311),_=r.a.memo(H.a,function(e,t){var a=e.spec,n=Object(U.a)(e,["spec"]),r=t.spec,o=Object(U.a)(t,["spec"]);return $()(n,o)&&z.a.isSameSpec(a,r)}),X=Object(l.a)(function(e){return{wrapper:{height:150,"&::after":{display:"block",position:"absolute",width:146,backgroundImage:"linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(0, 0, 0, 0.75))",height:"75%",content:"''",bottom:0,alignSelf:"center"}},image:{overflow:"hidden",height:150,width:146},preview:{position:"relative",userSelect:"none",width:150,marginTop:5,marginLeft:"auto",marginRight:"auto",border:2,borderColor:function(e){return e?"#3caea3":"lightgrey"},borderStyle:"solid","&:hover":{borderColor:function(e){return e?"#3caea3":"darkgrey"}},"&:active":{borderColor:function(e){return"grey"}}},center:{position:"absolute",left:"50%",transform:"translate(-50%, 0)"},top:{position:"absolute",right:0,top:0,"& button":{marginRight:e.spacing(1),marginTop:e.spacing(1)}},bottom:{bottom:10,color:"white"}}}),Y=function(e){var t=e.spec,a=e.operand1Id,o=e.active,i=Object(n.useState)(!1),l=Object(c.a)(i,2),u=l[0],s=l[1],p=Object(n.useState)(""),f=Object(c.a)(p,2),h=f[0],g=f[1],b=Object(n.useState)(""),y=Object(c.a)(b,2),w=y[0],E=y[1],j=Object(n.useState)(!1),k=Object(c.a)(j,2),O=k[0],C=k[1],S=Object(n.useContext)(q),x=X(o);return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{disableGutters:!0,className:x.preview,onClick:function(){if(!O){var e=t.id;S({type:"select-operand1",id:e===a?null:e})}}},r.a.createElement(W,{table:[["Data URL",t.spec.data.url],["Mark Type",t.spec.mark]]},r.a.createElement("div",{className:x.wrapper},r.a.createElement("div",{className:x.image},r.a.createElement(_,{spec:t.spec,width:150,height:150})))),r.a.createElement("div",{className:x.top},r.a.createElement(G.a,{size:"small",color:"primary",onClick:function(){g(d()(t.spec)),E(t.alias),s(!0)}},r.a.createElement(v.a,null)),r.a.createElement(G.a,{size:"small",color:"secondary",onClick:function(){S({type:"delete-spec",id:t.id})},onMouseEnter:function(){return C(!0)},onMouseLeave:function(){return C(!1)}},r.a.createElement(m.a,null))),r.a.createElement("div",{className:x.center+" "+x.bottom},t.alias)),r.a.createElement(L,{showModal:u,setShowModal:s,onSuccess:function(e,a){S({type:"modify-spec",json:a,alias:e,id:t.id})},value:h,setValue:g,alias:w,setAlias:E}))},K=Object(l.a)(function(e){return{list:{overflowY:"auto",overflowX:"hidden",flexGrow:1,paddingTop:0,paddingBottom:0,display:"flex",flexDirection:"column",alignContent:"center"}}}),Q=function(e){var t=e.currentState,a=K();return r.a.createElement(u.a,{className:a.list},t.specs.map(function(e){return r.a.createElement(Y,{key:e.id,spec:e,operand1Id:t.operand1Id,active:e.id===t.operand1Id})}))},Z=a(305),ee=a.n(Z),te=Object(l.a)(function(e){return{button:{marginBottom:e.spacing(1)}}}),ae=function(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(""),l=Object(c.a)(i,2),u=l[0],s=l[1],d=Object(n.useState)(""),p=Object(c.a)(d,2),m=p[0],f=p[1],v=Object(n.useContext)(q),h=te();return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{onClick:function(){s(""),f("Untitled"),o(!0)},className:h.button},r.a.createElement(ee.a,null)," \xa0 New Spec"),r.a.createElement(L,{showModal:a,setShowModal:o,onSuccess:function(e,t){v({type:"add-spec",json:t,alias:e})},value:u,setValue:s,alias:m,setAlias:f}))},ne=a(306),re=a.n(ne)()(function(e){return{main:{padding:10,border:2,borderColor:function(e){return e?"#3caea3":"lightgrey"},borderStyle:"solid","&:hover":{borderColor:function(e){return e?"#3caea3":"darkgrey"}},"&:active":{borderColor:function(e){return"grey"}},backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center"}}}),oe=function(e){var t=e.view,a=e.operand2Id,o=Object(n.useContext)(q),i=t.view.getId(),c=re(i===a);return r.a.createElement("div",{className:c.main,onClick:function(){o({type:"select-operand2-id",operandId:i===a?null:i})}},r.a.createElement(_,{spec:t.export()}))},ie=function(e){var t=e.view,a=e.operand2Id,o=Object(n.useContext)(q),i=t.view.getId(),c=re(i===a);return r.a.createElement("div",{className:c.main,onClick:function(){o({type:"select-operand2-id",operandId:i===a?null:i})}},r.a.createElement(_,{spec:t.export()}))},ce=Object(l.a)(function(e){return{main:{backgroundColor:e.palette.grey[200],marginTop:e.spacing(1),flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"}}}),le=function(e){var t=e.tree,a=e.operand2Id,n=ce();return r.a.createElement("div",{className:n.main},t?function(e){switch(e.view.getType()){case"unit":return r.a.createElement(oe,{view:e,operand2Id:a});case"layer":return r.a.createElement(ie,{view:e,operand2Id:a});default:throw new Error("".concat(e.view.getType()," view has not been implemented"))}}(t):"Empty View")},ue=a(307),se=a.n(ue),de=a(308),pe=a.n(de),me=a(506),fe=function(e){var t=e.specs,a=e.operand1Id,o=e.operand2Id,i=e.tree,c=Object(n.useContext)(q),l=function(e){t.forEach(function(t){t.id===a&&c({type:"operate",operand1:t.spec,operand2Id:o,operator:e})})},u=null===a||null===o,s=null===a||null===o,d=null!==a||null===o,p=null!==a||null===o,m=null===a||null!==o||null!==i;return r.a.createElement(me.a,{container:!0,justify:"space-between"},r.a.createElement(me.a,{item:!0},r.a.createElement(g.a,{onClick:function(){return l("layer")},disabled:u},"Layer"),r.a.createElement(g.a,{onClick:function(){return l("concat")},disabled:s},"Concat"),r.a.createElement(g.a,{onClick:function(){return l("repeat")},disabled:d},"Repeat"),r.a.createElement(g.a,{onClick:function(){return l("facet")},disabled:p},"Facet"),r.a.createElement(g.a,{onClick:function(){return l("place")},disabled:m},"Place")),r.a.createElement(me.a,{item:!0},r.a.createElement(g.a,{onClick:function(){return c({type:"undo"})}},r.a.createElement(se.a,null)," \xa0 Undo"),r.a.createElement(g.a,{onClick:function(){return c({type:"redo"})}},r.a.createElement(pe.a,null)," \xa0 Redo")))},ve=a(309),he=a(507),ge=a(508),be=a(509),ye=a(514),we=a(310),Ee=a(512),je=a(515),ke=a(510),Oe=a(31),Ce=a(29),Se=a(32),xe=a(25),Ie=a(27);function Ne(e){return JSON.parse(JSON.stringify(e))}var Me=0,Ve=function(){function e(t){Object(xe.a)(this,e),this.id=void 0,this.type=void 0,this.id=Me++,this.type=t}return Object(Ie.a)(e,[{key:"getType",value:function(){return this.type}},{key:"getId",value:function(){return this.id}}]),e}(),Te=function(){function e(t){Object(xe.a)(this,e),this.view=void 0,this.view=t}return Object(Ie.a)(e,[{key:"export",value:function(){return this.view.export()}},{key:"clone",value:function(){return new e(this.view.clone())}},{key:"findView",value:function(e){return this.view.getId()===e?this:this.view.findView(e)}}]),e}(),Be=function(e){function t(){return Object(xe.a)(this,t),Object(Oe.a)(this,Object(Ce.a)(t).apply(this,arguments))}return Object(Se.a)(t,e),t}(Ve),De=function(e){function t(e){var a;return Object(xe.a)(this,t),(a=Object(Oe.a)(this,Object(Ce.a)(t).call(this,"unit"))).spec=void 0,a.spec=Ne(e),a}return Object(Se.a)(t,e),Object(Ie.a)(t,[{key:"edit",value:function(e){this.spec=Ne(e)}},{key:"export",value:function(){return Ne(this.spec)}},{key:"clone",value:function(){var e=new t(Ne(this.spec));return e.id=this.id,e}},{key:"findView",value:function(e){return null}}]),t}(Ve),Re=function(e){function t(){var e;return Object(xe.a)(this,t),(e=Object(Oe.a)(this,Object(Ce.a)(t).call(this,"layer"))).layer=void 0,e.layer=[],e}return Object(Se.a)(t,e),Object(Ie.a)(t,[{key:"export",value:function(){return{layer:this.layer.map(function(e){return e.export()})}}},{key:"append",value:function(e){this.layer.push(new Te(e))}},{key:"prepend",value:function(e){this.layer.unshift(new Te(e))}},{key:"remove",value:function(e){this.layer.splice(e,1)}},{key:"isCompatible",value:function(e){var t=e.export();return!t.spec&&!t.layer&&!t.concat&&!t.hconcat&&!t.vconcat}},{key:"rearrange",value:function(e,t){!function(e,t,a){if(!(t in e&&a in e))throw new Error("from (=".concat(t,") or to (=").concat(a,") is out of arr bound (=[0,").concat(e.length-1,"])"));var n=e[t];if(t<a)for(var r=t;r<a;r++)e[r]=e[r+1];else for(var o=t;o>a;o--)e[o]=e[o-1];e[a]=n}(this.layer,e,t)}},{key:"clone",value:function(){var e=new t;return e.id=this.id,this.layer.forEach(function(t){e.layer.push(t.clone())}),e}},{key:"findView",value:function(e){return this.layer.forEach(function(t){var a=t.findView(e);if(null!==a)return a}),null}}]),t}(Be),Le=function(e,t){return{current:t(e.current),undoStack:he.a(e.current,e.undoStack),redoStack:[]}},Ae=function(e,t){switch(t.type){case"add-spec":return Le(e,function(e){var a=e.specs,n=e.specCount,r=Object(U.a)(e,["specs","specCount"]);return Object(ve.a)({specs:ge.a({id:n,spec:t.json,alias:t.alias},a),specCount:n+1},r)});case"modify-spec":return Le(e,be.a(ye.a("specs"),we.a(function(e){return e.id===t.id?{id:t.id,spec:t.json,alias:t.alias}:e})));case"delete-spec":return Le(e,Ee.a(be.a(ye.a("specs"),je.a(function(e){return e.id!==t.id})),be.a(ye.a("operand1Id"),function(e){return e===t.id?null:e})));case"undo":var a=e.current,n=e.undoStack,r=e.redoStack;return n.length>0?{redoStack:he.a(a,r),current:n[0],undoStack:n.slice(1)}:e;case"redo":var o=e.current,i=e.undoStack,c=e.redoStack;return c.length>0?{redoStack:c.slice(1),current:c[0],undoStack:he.a(o,i)}:e;case"select-operand1":return Le(e,be.a(ye.a("operand1Id"),ke.a(t.id)));case"select-operand2-id":return Le(e,be.a(ye.a("operand2Id"),ke.a(t.operandId)));case"operate":return Le(e,Ee.a(be.a(ye.a("tree"),function(e){if("place"===t.operator)return new Te(new De(t.operand1));var a=e.clone(),n=a.findView(null===t.operand2Id?-1:t.operand2Id);if(!n)throw new Error("focusing node is null expecting ViewHolder");switch(t.operator){case"layer":var r=new De(t.operand1);if(n.view instanceof Re&&n.view.isCompatible(r))n.view.append(r);else{var o=new Re;o.isCompatible(r)&&n.view instanceof De&&o.isCompatible(n.view)&&(o.append(n.view),o.append(r),n.view=o)}break;case"concat":case"repeat":case"facet":break;default:return function(e){throw new Error("Unexpected object: "+e)}(t.operator)}return a}),be.a(ye.a("operand1Id"),ke.a(null)),be.a(ye.a("operand2"),ke.a(null))));default:throw new Error("impossible")}},Fe={current:{specs:[],specCount:0,operand1Id:null,operand2Id:null,tree:null},undoStack:[],redoStack:[]},We=Object(l.a)(function(e){return{root:{height:600,display:"flex"},left:{height:"100%",display:"flex",flexDirection:"column",width:150,marginRight:e.spacing(1)},right:{flexGrow:1,display:"flex",flexDirection:"column"}}}),Ge=function(){var e=Object(n.useReducer)(Ae,Fe),t=Object(c.a)(e,2),a=t[0],o=t[1],i=We();return r.a.createElement(q.Provider,{value:o},r.a.createElement("div",{className:i.root},r.a.createElement("div",{className:i.left},r.a.createElement(ae,null),r.a.createElement(Q,{currentState:a.current})),r.a.createElement("div",{className:i.right},r.a.createElement(fe,{specs:a.current.specs,operand1Id:a.current.operand1Id,operand2Id:a.current.operand2Id,tree:a.current.tree}),r.a.createElement(le,{tree:a.current.tree,operand2Id:a.current.operand2Id}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[318,1,2]]]);
//# sourceMappingURL=main.d6e0ac44.chunk.js.map